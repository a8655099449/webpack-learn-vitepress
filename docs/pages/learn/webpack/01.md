# åœ¨webpackä¸­ç»†è‡´çš„å¤„ç†jsèµ„æº

jsæ–‡ä»¶webpackæœ¬èº«å°±èƒ½å¤„ç†ï¼Œä½†åˆå§‹èƒ½åšçš„äº‹æƒ…å®åœ¨æœ‰é™ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ æ›´å¤šçš„è§„åˆ™ï¼Œæ¥ä½¿ä½ çš„é¡¹ç›®æ›´åŠ çš„å¾—å¿ƒåº”æ‰‹

1. è®©ä½ çš„jsä»£ç å¢åŠ ä»£ç æ ¼å¼éªŒè¯ï¼Œç¡®ä¿å›¢é˜Ÿä»£ç é£æ ¼ã€è´¨é‡ä¿æŒä¸€è‡´ ï¼Œ ä¸»è¦ä½¿ç”¨åˆ°[eslint](https://eslint.bootcss.com/)
2. ç¼–è¯‘ä½ çš„jsä»£ç ï¼Œä½¿å…¶å¯ä»¥å…¼å®¹æ›´ä½ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œä¾èµ–äº[babel.js](https://www.babeljs.cn/)



## eslint

`eslint`æ˜¯æ£€æµ‹JavaScriptä»£ç æ ¼å¼çš„ä¸€ç§å·¥å…·ï¼Œå¯ä»¥æ›´å¥½çš„æå‡å›¢é˜Ÿä»£ç è´¨é‡

eslintçš„åšæŒè§„åˆ™ï¼Œä¾èµ–äºé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­æ·»åŠ ä»¥ä¸‹å‡ ç§å‘½åçš„æ–‡ä»¶æ¥è§†ä¸ºeslintçš„é…ç½®æ–‡ä»¶

- `.eslintrc`
- `.eslintrc.js`
- `.eslintrc.json`
- `package.json`ä¸­çš„`eslintConfig`å­—æ®µï¼Œè¿™ç§å†™æ³•ä¸éœ€è¦æ–°å»ºæ–‡ä»¶

eslintä¼šè‡ªåŠ¨å¯»æ‰¾ä»–ä»¬ï¼Œä»¥ä¸Šçš„é…ç½®åªéœ€è¦å­˜åœ¨ä¸€ç§å³å¯



### å®‰è£…eslint 

åœ¨[Configuring ESLint](https://eslint.bootcss.com/docs/user-guide/getting-started)ä¸­æˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°eslintçš„åˆå§‹ä½¿ç”¨ï¼Œè¿™é‡Œæˆ‘åªæ˜¯è‡ªå·±æ¬è¿ä¸€äº›ç®€ç•¥çš„å†…å®¹


```sh
yarn add eslint --save-dev

npx eslint --init
```
è¾“å…¥ä»¥ä¸Šçš„å‘½ä»¤ä¹‹åï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåˆå§‹çš„é…ç½®æ–‡ä»¶

```js
module.exports = {
  env: {
    browser: true, // å¯åŠ¨æµè§ˆä¸­çš„å…¨å±€å˜é‡
    es2021: true,
  },
  // ç»§æ‰¿æŸç§è§„åˆ™
  extends: [],
  // è§£æé€‰é¡¹
  parserOptions: {
    ecmaVersion: 'latest', // ä½¿ç”¨ä»€ä¹ˆç‰ˆæœ¬çš„jsä»£ç 
    sourceType: 'module', // æ¨¡å—æ–¹å¼ä½¿ç”¨çš„æ˜¯å“ªç§ï¼Ÿ
  },
  // é…ç½®è§„åˆ™
  rules: {
    "no-var": 2 // ä¸å¯ä»¥ä½¿ç”¨varæ¥å®šä¹‰å˜é‡
  },
};
```
æˆ‘ä»¬å¯ä»¥åœ¨[eslintçš„å®˜æ–¹ä¸­æ–‡æ–‡æ¡£](https://eslint.bootcss.com/docs/user-guide/configuring)æ‰¾åˆ°å…³äºeslintçš„æ‰€æœ‰é…ç½®

### å°†eslintä¸webpackç»“åˆ


eslintå’Œwebpackç»“åˆä¹‹åï¼Œäº§ç”Ÿçš„ç°è±¡å½“ç„¶å°±æ˜¯ï¼Œå¦‚æœä½ çš„ä»£ç å†™çš„åƒåœ¾ï¼Œä½ å°±æ²¡æ³•æ‰“åŒ…ã€‚è¿™æ˜¯ä¸€ç§å¼ºåˆ¶ä½ å†™å¥½ä»£ç çš„è§„åˆ™ã€‚

å½“ç„¶å¦‚æœä½ åªæ˜¯ä¸€ä¸ªåˆšå¼€å§‹å­¦ä¹ çš„å°ç™½ï¼Œè¿™äº›è§„åˆ™ä¼šè®©ä½ ç—›è‹¦æ— æ¯”ï¼Œæœ€ååªèƒ½è¢«è¿«å…³æ‰å®ƒä»¬ã€‚ä½†è‰¯å¥½çš„ä¹ æƒ¯æ€»æ˜¯åœ¨ä¸¥è‹›çš„ç¯å¢ƒä¸­å…»æˆçš„ï¼Œå¦‚æœä½ èƒ½å¾ˆå¥½çš„éµå®ˆè§„åˆ™ï¼Œå°±å¯ä»¥å‡å°‘ä»£ç å‡ºé”™çš„æ¦‚ç‡ã€‚

> äººç±»æ€»æ˜¯å–œæ¬¢ä½¿ç”¨å„ç§å„æ ·çš„è§„åˆ™ï¼Œæ¥é™åˆ¶è‡ªå·±ï¼Œå› ä¸ºä¸€æ—¦äººç±»è„±ç¦»é™åˆ¶ï¼Œå°±ä¼šå˜å¾—è‚†æ— å¿Œæƒ®ã€‚



eslintåœ¨webpackä¸­å±äºä¸€ä¸ªæ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨[EslintWebpackPlugin](https://webpack.docschina.org/plugins/eslint-webpack-plugin/)çœ‹åˆ°å…³äºå®ƒçš„ä½¿ç”¨

```sh
yarn add eslint-webpack-plugin --save-dev
```
ç„¶åæŠŠæ’ä»¶æ·»åŠ åˆ°ä½ çš„ webpack é…ç½®ã€‚ä¾‹å¦‚ï¼š
```js

const ESLintPlugin = require('eslint-webpack-plugin');

module.exports = {
  // ...
  plugins: [new ESLintPlugin({
    context: resolve(__dirname, 'src') // åªå¯¹srcä¸‹çš„ç›®å½•è¿›è¡Œä»£ç æ£€æŸ¥
  })],
  // ...
};
```

ç„¶ååœ¨index.jsä¸­æ·»åŠ ä¸€ç‚¹è¿è§„ä»£ç ï¼Œæ¯”å¦‚

```js
var a = 2  // åœ¨ä¸Šé¢çš„è§„åˆ™ä¸­æˆ‘ä»¬ä½¿ç”¨äº† "no-var" è§„åˆ™ï¼Œæ‰€ä»¥è¿™è¡Œä»£ç ä¼šè¿›è¡ŒæŠ¥é”™
```
ç„¶åæ‰§è¡Œ`webpack`å‘½ä»¤ï¼Œæœç„¶å°±å¼€å§‹æç¤ºé”™è¯¯äº†

![](//image.woai996.com/20220618173638.png)

å¹¶ä¸”å¦‚æœä½ å®‰è£…äº†`vscode`ä¸­çš„`eslint`æ’ä»¶ï¼Œé”™è¯¯å°†ä¼šåœ¨ä½ ç¼–å†™çš„æ—¶å€™ç›´æ¥æç¤ºå‡ºæ¥ 

![](//image.woai996.com/20220618174036.png)

### å¿½ç•¥æŸäº›æ–‡ä»¶çš„eslintæ£€è½¦

æ¯”å¦‚æˆ‘ä»¬æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶ï¼Œä¸éœ€è¦è¿›è¡Œä»£ç æ£€æµ‹ï¼Œåªéœ€è¦æ–°å»ºä¸€ä¸ªæ–‡ä»¶`.eslintignore`åœ¨å…¶ä¸­æ·»åŠ ä½ ä¸æƒ³æ£€æµ‹çš„ç›®å½•å³å¯



## babel

babel æ˜¯ä¸€ä¸ªjsç¼–è¯‘å™¨ï¼Œå®ƒè·Ÿwebpageæœ‰ç€æœ¬è´¨çš„åŒºåˆ«ï¼ŒBabelå¯ä»¥å°†ä½ çš„javascriptä»£ç ç¼–è¯‘æˆä½ éœ€è¦çš„æ¨¡æ ·ï¼Œè€Œwebpackåªæ˜¯ä¸€ä¸ªæ‰“åŒ…å·¥å…·ï¼Œå¯¹å…¶ä¸­å†…å®¹çš„ä¿®æ”¹æ¯”è¾ƒæœ‰é™ï¼Œä¸“ä¸šçš„äº‹æƒ…éœ€è¦äº¤ç»™ä¸“ä¸šçš„å·¥å…·ã€‚

æ¯”å¦‚ä½ å¸Œæœ›ä½ ç¼–å†™çš„ä»£ç èƒ½å¤Ÿè¿è¡Œåœ¨`ieæµè§ˆå™¨`ä¸Šï¼Œé‚£ä¹ˆäº¤ç»™Babelå¤„ç†æ˜¯ä¸ªå¯é çš„é€‰æ‹©


åœ¨ä½¿ç”¨å‰æˆ‘ä»¬æœ€å¥½è§‚çœ‹ä»¥ä¸‹çš„æ–‡æ¡£ , å½“ç„¶ä¹Ÿå¯ä»¥ä¸çœ‹ç›´æ¥æŒ‰ç…§æˆ‘çš„ä»£ç æ¥å†™

1. [webpackä¸­çš„babel-loader](https://webpack.docschina.org/loaders/babel-loader#root)
2. [babelä½¿ç”¨æŒ‡å—](https://www.babeljs.cn/docs/usage)


### babelé…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶æœ‰è®¸å¤šç§å†™çš„æ–¹æ¡ˆ
- `babel.config.json`
- `babel.config.js`
- `.babelrc`
  - `.babelrc.js`
  - `.babelrc.json`
- package.json ä¸­çš„`babel`å­—æ®µ

babelä¼šå…¨å±€æŸ¥æ‰¾å®ƒä»¬ã€‚å®ƒä»¬ä¸­åªéœ€è¦å­˜åœ¨ä¸€ä¸ªå³å¯ã€‚

åœ¨`babel7`ä»¥ä¸Šçš„ç‰ˆæœ¬å®˜æ–¹æ¨èä½¿ç”¨`babel.config.json`è¿™ç§ï¼Œåœ¨vscodeä¸­ä¼šæœ‰ä»£ç æç¤ºï¼Œæˆ‘ä¹Ÿä½¿ç”¨è¿™ç§
> æ’å¥é¢˜å¤–è¯ åœ¨è¿™äº›é…ç½®æ–‡ä»¶ä¸­ï¼Œå…¶å®ä½¿ç”¨`.json`çš„å½¢å¼å…·æœ‰ä»¥ä¸‹çš„ä¼˜ç‚¹
> 1. åœ¨jsonæ–‡ä»¶ä¸­ä¹Ÿå¯ä»¥è¿›è¡Œæ³¨é‡Š
> 2. å¯ä»¥è·å¾—tsçš„ç±»å‹æç¤ºï¼Œæ›´åŠ æ–¹ä¾¿æ“ä½œã€‚


### åœ¨webpackä¸­ä½¿ç”¨babel

åœ¨webpackä¸­babelä¸æ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œè€Œæ˜¯ä¸€ä¸ª`loader`

1. å®‰è£…ä¾èµ–
```shell
yarn add -D babel-loader @babel/core @babel/preset-env
```
 
2. åœ¨`é…ç½®æ–‡ä»¶ä¸­`æ·»åŠ ä¸Šè¿™æ®µï¼Œè·Ÿå®˜ç½‘çš„æœ‰äº›å‡ºå…¥ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¼šæŠŠè¯¦ç»†çš„é…ç½®å†™åœ¨`babel.config.json`ä¸­

```js
module: {
  rules: [
    {
      test: /\.js$/,
      exclude: /(node_modules)/,
      use: {
        loader: 'babel-loader',
      }
    }
  ]
}
```

3. åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­æ·»åŠ æ–‡ä»¶`babel.config.json` ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹

```json
{
  // é¢„è®¾
  "presets": [
    "@babel/preset-env"
  ]
}
```


ç„¶ååœ¨æŸ¥çœ‹æ‰“åŒ…æ•ˆæœå‰æ˜¾ç„¶æˆ‘ä»¬çœ‹ä¸€æ®µæ²¡æœ‰æ·»åŠ Babelçš„æ‰“åŒ…ä»£ç 

è¿™æ˜¯æˆ‘ä»¬çš„æºæ–‡ä»¶ï¼Œåº”ç”¨åˆ°äº†æœ€æ–°çš„jsç‰¹æ€§
```javascript
// src/index.js

let person = {
  name: 'å¼ ä¸‰',
  age: 18
}

const add = ({ a, b }) => a + b

console.log('ğŸ‘´', person?.gender)
console.log('ğŸ‘´', add({
  a: 1,
  b: 2
}))

console.log('ğŸ‘´Promise',Promise)
```

è¿™æ˜¯æ²¡æœ‰æ·»åŠ babelçš„æ‰“åŒ…ä»£ç ,å¯ä»¥çœ‹åˆ°å‡ ä¹æ²¡æœ‰åšå£°æ˜å¤„ç†

```js
console.log("ğŸ‘´",{name:"å¼ ä¸‰",age:18}?.gender),console.log("ğŸ‘´",(({a:o,b:e})=>o+e)({a:1,b:2})),console.log("ğŸ‘´Promise",Promise);
```

**ä½¿ç”¨babelåçš„æ•ˆæœ**

```javascript
(()=>{var o,e={name:"å¼ ä¸‰",age:18};console.log("ğŸ‘´",null==e?void 0:e.gender),console.log("ğŸ‘´",(o={a:1,b:2}).a+o.b),console.log("ğŸ‘´Promise",Promise)})();
```
å¯ä»¥çœ‹åˆ°å·²ç»åšäº†ä¸€äº›å…¼å®¹æ€§çš„å¤„ç†äº†ï¼Œä½†æ•ˆæœä¸æ˜æ˜¾ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰æ·»åŠ è¶³å¤Ÿçš„é…ç½®

æˆ‘ä»¬å¯ä»¥å¤šé…ç½®ä¸€äº›ä¿¡æ¯è®©Babeljsåšæ›´å¤šçš„å¤„ç†

```json
{
  "presets": [
    [
      "@babel/preset-env",
      {
        "targets": {
          "edge": "17",
          "firefox": "60",
          "chrome": "67",
          "safari": "11.1"
        },
        "useBuiltIns": "usage",
        "corejs": "3.6.5"
      }
    ]
  ]
}
```

ç„¶åéœ€è¦å®‰è£…`core-js`

```sh
yarn add  -D @babel/cli  core-js
```
å†è¿›è¡Œç¼–è¯‘ï¼Œè¿™æ—¶å°±å¯ä»¥çœ‹åˆ°å¤šå‡ºå¾ˆå¤šçš„ä»£ç äº†
![](//image.woai996.com/20220618213502.png)


ä¸»è¦çš„åŸå› æ˜¯babelä¼šåœ¨ä½ çš„ä»£ç ä¸­å®ç°`Promise`































